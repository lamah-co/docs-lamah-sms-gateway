---
title: 'Initiate OTP'
description: 'Generate and send a one-time password (OTP) via SMS'
---

## Overview

Generate and send a one-time password (OTP) to a phone number for verification purposes. This endpoint creates a secure OTP and sends it via SMS, returning a request ID that can be used to verify the code later.

## Endpoint

<CodeGroup>

```bash cURL
curl --request POST \
  "https://sms.lamah.com/api/otp/initiate" \
  --header "Authorization: Bearer YOUR_API_TOKEN" \
  --header "Content-Type: application/json" \
  --data '{
    "lang": "ar",
    "length": 6,
    "expiration": 5,
    "sender": "RealEstate",
    "payment_type": "wallet",
    "receiver": "00218912345678"
  }'
```

```javascript JavaScript
const response = await fetch('https://sms.lamah.com/api/otp/initiate', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer YOUR_API_TOKEN',
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    lang: 'ar',
    length: 6,
    expiration: 5,
    sender: 'RealEstate',
    payment_type: 'wallet',
    receiver: '00218912345678'
  })
});

const data = await response.json();
console.log(data);
```

```python Python
import requests

url = "https://sms.lamah.com/api/otp/initiate"
headers = {
    "Authorization": "Bearer YOUR_API_TOKEN",
    "Content-Type": "application/json"
}
payload = {
    "lang": "ar",
    "length": 6,
    "expiration": 5,
    "sender": "RealEstate",
    "payment_type": "wallet",
    "receiver": "00218912345678"
}

response = requests.post(url, headers=headers, json=payload)
print(response.json())
```

```php PHP
<?php
$curl = curl_init();

curl_setopt_array($curl, array(
  CURLOPT_URL => 'https://sms.lamah.com/api/otp/initiate',
  CURLOPT_RETURNTRANSFER => true,
  CURLOPT_CUSTOMREQUEST => 'POST',
  CURLOPT_POSTFIELDS => json_encode([
    'lang' => 'ar',
    'length' => 6,
    'expiration' => 5,
    'sender' => 'RealEstate',
    'payment_type' => 'wallet',
    'receiver' => '00218912345678'
  ]),
  CURLOPT_HTTPHEADER => array(
    'Authorization: Bearer YOUR_API_TOKEN',
    'Content-Type: application/json'
  ),
));

$response = curl_exec($curl);
curl_close($curl);
echo $response;
?>
```

</CodeGroup>

## Request Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `lang` | string | ✅ | Language for the OTP message: `ar` or `en` |
| `length` | integer | ✅ | Length of the OTP code: `4` or `6` |
| `expiration` | integer | ✅ | Expiration time in minutes (range: 1–10) |
| `sender` | string | ✅ | The sender ID (up to 11 characters) |
| `payment_type` | string | ✅ | Payment method: `wallet` or `subscription` |
| `receiver` | string | ✅ | The recipient's phone number in international format |

### Parameter Details

<AccordionGroup>
  <Accordion title="lang">
    The language for the OTP message template.
    
    - **`en`**: English message template
    - **`ar`**: Arabic message template
    - **Default templates**: Pre-defined secure message formats
  </Accordion>
  
  <Accordion title="length">
    The number of digits in the OTP code.
    
    - **`4`**: 4-digit code (e.g., 1234)
    - **`6`**: 6-digit code (e.g., 123456)
    - **Security**: 6-digit codes provide better security
  </Accordion>
  
  <Accordion title="expiration">
    How long the OTP remains valid.
    
    - **Range**: 1 to 10 minutes (inclusive)
    - **Guidance**: Shorter durations (1–5) increase security; longer durations (6–10) improve UX
  </Accordion>
  
  <Accordion title="sender">
    The sender ID that will appear on the recipient's device.
    
    - **Length**: Maximum 11 characters
    - **Format**: Alphanumeric characters only
    - **Examples**: `Lamah`, `Verify`, `Security`
  </Accordion>
  
  <Accordion title="payment_type">
    Specifies how the OTP SMS cost will be charged.
    
    - **`wallet`**: Deduct from your account balance
    - **`subscription`**: Use your subscription plan credits
  </Accordion>
  
  <Accordion title="receiver">
    The recipient's phone number in international format.
    
    - **Format**: Must include country code (e.g., `+218912345678` or `00218912345678`)
    - **Validation**: Number will be validated before sending
  </Accordion>
</AccordionGroup>

## Response

### Success Response (200 OK)

```json
{
  "request_id": "8c8a6f2f-9a3b-4d86-9b2c-1e3f8f9c2ab1",
  "cost": 1
}
```

### Response Fields

| Field | Type | Description |
|-------|------|-------------|
| `request_id` | string | UUID for this OTP request |
| `cost` | number | Number of SMS parts charged for this send |

## Error Responses

### 400 Bad Request - Invalid Parameters

```json
{ "message": "The length field must be one of: 4, 6." }
```

### 400 Bad Request - Invalid Expiration

```json
{ "message": "The expiration field must be between 1 and 10." }
```

### 400 Bad Request - Invalid Phone Number

```json
{ "message": "Invalid phone number" }
```

### 401 Unauthorized

```json
{ "message": "Unauthenticated." }
```

### 402 Payment Required

```json
{ "message": "Insufficient balance" }
```

### 429 Too Many Requests

```json
{ "message": "Too many requests." }
```

## Message Templates

### English Template (lang: "en")
```
Your verification code is: {CODE}
This code expires in {EXPIRATION} minutes.
```

### Arabic Template (lang: "ar")
```
رمز التحقق الخاص بك هو: {CODE}
ينتهي هذا الرمز خلال {EXPIRATION} دقائق.
```

## Rate Limits

<Warning>
  **OTP Rate Limits**: Limited to 10 OTP requests per minute per phone number to prevent abuse.
</Warning>

### Rate Limit Details

- **Per phone number**: 10 requests per minute
- **Per project**: 1000 requests per minute
- **Cooldown period**: 60 seconds after rate limit is hit

## Security Best Practices

<CardGroup cols={2}>
  <Card title="Use 6-digit codes" icon="shield">
    6-digit codes provide better security than 4-digit codes
  </Card>
  <Card title="Short expiration" icon="clock">
    Use 1-5 minute expiration for sensitive operations
  </Card>
  <Card title="Rate limiting" icon="gauge">
    Implement client-side rate limiting to prevent abuse
  </Card>
  <Card title="Secure storage" icon="lock">
    Never log or store the actual OTP codes
  </Card>
</CardGroup>

## Implementation Example

<CodeGroup>

```javascript Complete OTP Flow
class OTPService {
  constructor(apiToken) {
    this.apiToken = apiToken;
    this.baseUrl = 'https://sms.lamah.com/api';
  }

  async initiateOTP(phoneNumber, options = {}) {
    const defaultOptions = {
      lang: 'en',
      length: 6,
      expiration: 5,
      sender: 'Lamah',
      payment_type: 'wallet'
    };

    const otpData = {
      ...defaultOptions,
      ...options,
      receiver: phoneNumber
    };

    try {
      const response = await fetch(`${this.baseUrl}/otp/initiate`, {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${this.apiToken}`,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(otpData)
      });

      if (!response.ok) {
        const error = await response.json();
        throw new Error(`OTP initiation failed: ${error.message}`);
      }

      const result = await response.json();
      
      // Store request_id for verification
      this.storeOTPRequest(phoneNumber, result.request_id);
      
      return result;
      
    } catch (error) {
      console.error('OTP initiation error:', error);
      throw error;
    }
  }

  storeOTPRequest(phoneNumber, requestId) {
    // Store in your database or cache
    // This is just an example using localStorage
    const otpData = {
      requestId,
      phoneNumber
    };
    localStorage.setItem(`otp_${phoneNumber}`, JSON.stringify(otpData));
  }

  getStoredOTPRequest(phoneNumber) {
    const stored = localStorage.getItem(`otp_${phoneNumber}`);
    return stored ? JSON.parse(stored) : null;
  }
}

// Usage
const otpService = new OTPService('YOUR_API_TOKEN');

const sendOTP = async (phoneNumber) => {
  try {
    const result = await otpService.initiateOTP(phoneNumber, {
      length: 6,
      expiration: 5,
      lang: 'en'
    });
    
    console.log('OTP sent successfully:', result.request_id);
    return result;
    
  } catch (error) {
    console.error('Failed to send OTP:', error.message);
    return null;
  }
};
```

```python Complete OTP Flow
import requests
import json
from datetime import datetime

class OTPService:
    def __init__(self, api_token):
        self.api_token = api_token
        self.base_url = 'https://sms.lamah.com/api'
        self.headers = {
            'Authorization': f'Bearer {api_token}',
            'Content-Type': 'application/json'
        }

    def initiate_otp(self, phone_number, **options):
        default_options = {
            'lang': 'en',
            'length': 6,
            'expiration': 5,
            'sender': 'Lamah',
            'payment_type': 'wallet'
        }
        
        otp_data = {**default_options, **options, 'receiver': phone_number}
        
        try:
            response = requests.post(
                f'{self.base_url}/otp/initiate',
                headers=self.headers,
                json=otp_data
            )
            
            if not response.ok:
                error = response.json()
                raise Exception(f"OTP initiation failed: {error.get('message', 'Unknown error')}")
            
            result = response.json()
            
            # Store request_id for verification
            self.store_otp_request(phone_number, result['request_id'])
            
            return result
            
        except Exception as error:
            print(f"OTP initiation error: {error}")
            raise error

    def store_otp_request(self, phone_number, request_id):
        # Store in your database or cache
        # This is just an example using a simple dict
        otp_data = {
            'request_id': request_id,
            # add your own TTL/expiration handling if needed
            'phone_number': phone_number
        }
        # In production, use a proper database or cache
        print(f"Store OTP request: {otp_data}")

# Usage
otp_service = OTPService('YOUR_API_TOKEN')

def send_otp(phone_number):
    try:
        result = otp_service.initiate_otp(
            phone_number,
            length=6,
            expiration=5,
            lang='en'
        )
        
        print(f"OTP sent successfully: {result['request_id']}")
        return result
        
    except Exception as error:
        print(f"Failed to send OTP: {error}")
        return None
```

</CodeGroup>

## Next Steps

After initiating an OTP, you'll need to verify the code that the user receives. Use the [Verify OTP](/api-reference/otp/verify) endpoint with the `request_id` returned from this endpoint.

## Common Use Cases

<CardGroup cols={2}>
  <Card title="User Registration" icon="user-plus">
    Verify phone numbers during account creation
  </Card>
  <Card title="Login Verification" icon="sign-in">
    Two-factor authentication for secure login
  </Card>
  <Card title="Password Reset" icon="key">
    Verify identity before allowing password changes
  </Card>
  <Card title="Transaction Confirmation" icon="credit-card">
    Confirm high-value transactions or sensitive operations
  </Card>
</CardGroup>
